# 6. Функції та файли

## Файли

Робота з файлами складається з трьох етапів:

1. Відкриття файлу.
2. Маніпуляції із даними.
3. Закриття файлу.

### Відкриття файлу

Для відкриття файлу використовується функція **fopen**. Параметрами функції є ім'я файлу та режим відкриття файлу. Функція повертає дескриптор файлу, який дозволяє працювати з уже відкритим файлом.

```php
$file = fopen('file.txt', 'r+');
```
 
- **r** – відкриття файлу лише для читання
- **r+** – відкриття файлу одночасно на читання та запис
- **w** – створення нового порожнього файлу. Якщо на момент виклику вже існує такий файл, він знищується
- **w+** - аналогічний r+, тільки якщо на момент виклику такий файл існує, його вміст видаляється
- **a** – відкриває існуючий файл у режимі запису, при цьому вказівник зсувається на останній байт файлу (на кінець файлу)
- **a+** - відкриває файл у режимі читання та запису при цьому покажчик зсувається на останній байт файлу (на кінець файлу). Вміст файлу не видаляється

### Робота з даними файлу

**`fgets()`** використовується для читання рядків із файлу, приймає один обов'язковий та один необов'язковий параметр. Перший параметр - обробник файлу, файл handler, який створюється функцією `fopen`. Другий параметр – кількість символів.

**`fwrite()`** застосовується для запису у файл. Вона має три параметри: обов'язковий file handler, обов'язковий параметр "що писати у файл", і необов'язковий - вказівку кількості символів.

Файл також можна прочитати відразу весь, в масив, за допомогою функції **`file()`**. Ця функція приймає єдиний параметр - ім'я файлу і не вимагає handler-а.

За допомогою **`feof()`** з єдиним параметром handler можна перевірити, чи файл закінчився.

### Закриття файлу

Файл закривається викликом функції **`fclose()`**, що приймає єдиним параметром хендлер файлу.

### Приклад роботи з файлами

```php
//читаємо файл у масив
$file_array = file("counter.txt");
//відкриття файлу
$file = fopen('file.txt', r+);
//перевірка, чи не закінчився файл
while (! feof($file)) {
//читання з файлу
  $s = fgets($file);
  echo $s;
}
//закриття файлу
fclose($file);
````
 
Щоб переглянути інші функції роботи з файлами, перейдіть за посиланням нижче.
[Всі функції для роботи з файлами](http://www.php.su/articles/?cat=fs&page=005)

## Функції php

Програміст часто використовує вбудовані функції мови і часто пише свої. Функції мови виглядають як ім'я функції, за якою у дужках йдуть параметри функції.

`результат = ім'я_функції(параметр1, параметр2...)`

Як правило, функція повертає якесь значення у відповідь.

Приклади деяких корисних функцій:
```php
$ var = 12;

//функція is_int() перевіряє, чи є її параметр цілим числом.
//Повертає true, якщо ціле число, false, якщо ні.
echo is_int($var);

//Функція isset($var) перевіряє, чи визначено змінну
if (isset ($ var)) echo "It is set";

//Функція empty($var) перевіряє, чи не порожня змінна
if (! empty($var)) echo "It is not empty";

//Функції print_r та var_dump здійснюють більш докладний висновок
var_dump($var);
print_r($var);
````

## Опис вбудованої функції php

Детальний розгляд мануалу за будь-якою вбудованою функцією php покаже нам її опис, подібний до наступного:

`int intval ( mixed $var [, int $base = 10 ] )`

Це [опис](http://php.net/manual/ru/function.intval.php) функції intval в офіційній документації php.
У даному описі функції ліворуч:

* **int** - тип значення, що повертається функцією. Якщо void – функція нічого не повертає.
* **intval** - ім'я функції.
* **mixed** - тип аргументу. У разі - змішаний тип, тобто. можливі різні типи.
* $**var** - аргумент, який передається у функцію.
* **[int $base]** - у квардатних дужках вказується необов'язковий аргумент. Якщо перед ним написаний тип - то при його передачі тип повинен дотримуватися.
* **$base = 10** - якщо після аргументу йде надання йому значення - це його значення за умовчанням. Якщо аргумент не було передано, йому надається значення за замовчуванням.

Таким чином, з опису вище ми бачимо, що функція intval повертає ціле число, отримує як аргумент один обов'язковий аргумент змішаного типу і один необов'язковий, за умовчанням рівний десяти.

За посиланням досить непогана добірка [вбудованих функцій](http://site-on.net/create/php/13-built-in-functions).

## Написання своєї функції

```php
<?php
function by_tens($number) {
     $i = 10;
     while ($i <= $number) {
         echo "$i\n";
         $i += 10;
     }
     return true;
}
by_tens(120);
}
````

Функція створюється за допомогою зарезервованого слова **function**. Потім слідує ім'я функції, потім у дужках перелік аргументів функції. Після закриває дужки переліку аргументів слідує блок операторів, аналогічний блоку в **`if`** або **`while`**.

Інше зарезервоване слово, важливе створення функцій - слово **`return`**. У тілі функції може зустрічатися скільки завгодно операторів "return". Якщо виконується **`return`**, функція завершує свою роботу, повертаючи результат обчислення виразу, переданого **`return`**, як результат роботи функції.

Параметри, які ми передаємо у функцію, можуть бути посиланнями:

```php
function addFive($num) {
     $num + = 5;
}

function addSix(&$num) {
     $num + = 6;
}

$orignum = 10;

addFive($orignum);
echo "Original Value is $orignum"; //10

addSix($orignum);
echo "Original Value is $orignum"; //16
````

## Практика

- Написати підрахунок суми масиву за допомогою **for** та **while**
- написати функцію банкомату. Банкомат видає суму максимально можливими купюрами.

## Домашка

[Домашнє завдання](hw6.md)
